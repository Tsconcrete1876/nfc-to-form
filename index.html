<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>NFC to Google Form</title>
</head>
<body>
  <h2>請掃描 NFC 標籤...</h2>
  <p id="status">等待中...</p>

  <!-- <button onclick="readNFC()">開始掃描 NFC</button> -->

  <script>
    async function readNFC() {
      if ("NDEFReader" in window) {
        const ndef = new NDEFReader();
        try {
          await ndef.scan();
          document.getElementById("status").textContent = "請靠近 NFC 標籤...";
          ndef.onreading = event => {
            console.log("NFC 標籤讀取成功:", event);
            const record = event.message.records[0];
            console.log("NFC 內容:", record);

            const uint8Array = new Uint8Array(record.data);
            const id = String.fromCharCode.apply(null, uint8Array);
            console.log("解析出的 NFC ID:", id);

            document.getElementById("status").textContent = "讀取成功，跳轉中...";

            const formUrl = "https://docs.google.com/forms/d/e/iXm2c9xB2kfW16uXA/formResponse?entry.680740836=" + encodeURIComponent(id);
            window.location.href = formUrl;
          };
        } catch (error) {
          document.getElementById("status").textContent = "NFC 錯誤：" + error;
        }
      } else {
        document.getElementById("status").textContent = "這台裝置不支援 Web NFC。請使用 Android Chrome。";
      }
    }

    // 頁面載入後自動執行
    window.addEventListener("DOMContentLoaded", readNFC);
  </script>
</body>
</html>
